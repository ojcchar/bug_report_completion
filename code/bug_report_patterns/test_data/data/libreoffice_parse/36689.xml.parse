<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
	<id>36689</id>
	<title>SUMPRODUCT slow compared to SUMIF</title>
	<description>
		<paragraph id="1">
			<sentence id="1.1">Created attachment 46163
Workbook with 2 sheets.</sentence>
			<sentence id="1.2">Bug is (hopefully) well explained on the second sheet.</sentence>
		</paragraph>
		<paragraph id="2">
			<sentence id="2.1">When making the same calculation with SUMPRODUCT and SUMIF in the attached workbook, the former takes considerably longer than the latter.</sentence>
			<sentence id="2.2">And, with only 14,000 rows, I believe it should be near instantaneous.</sentence>
		</paragraph>
		<paragraph id="3">
			<sentence id="3.1">I've checked with a git pull of the master branch (as of 4:30pm -0400 22 Apr) and though the performance is better than the 14+ seconds I see with LO 3.3, it is currently still taking 4 seconds.</sentence>
			<sentence id="3.2">Given that the equivalent SUMIF appears to return immediately, I wonder if there are still some gains to be had.</sentence>
		</paragraph>
		<paragraph id="4">
			<sentence id="4.1">Is this a performance issue?</sentence>
			<sentence id="4.2">Or am I misunderstanding something about Calc's API in regards to SUMPRODUCT?</sentence>
		</paragraph>
		<paragraph id="5">
			<sentence id="5.1">I have only tested with an x86-64 kernel (real hardware) as that's all I have.</sentence>
		</paragraph>
		<paragraph id="6">
			<sentence id="6.1">If it's of use:</sentence>
		</paragraph>
		<paragraph id="7">
			<sentence id="7.1">$ uname -a
Linux hani 2.6.35-28-generic #50-Ubuntu SMP Fri Mar 18 18:42:20 UTC 2011 x86_64 GNU/Linux</sentence>
		</paragraph>
	</description>
</bug>
