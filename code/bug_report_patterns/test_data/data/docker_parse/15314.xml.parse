<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
	<id>15314</id>
	<title>rm -rf fails with 'invalid argument' while building on overlayfs, CentOS 7.1</title>
	<description>
		<paragraph id="1">
			<sentence id="1.1">I'm unable to build docker images on an up-to-date CentOS 7.1 machine using ext4-backed overlayfs.</sentence>
			<sentence id="1.2">An `rm -rf` of a non-empty directory that was created on a previous layer seems to fail consistently.</sentence>
		</paragraph>
		<paragraph id="2">
			<sentence id="2.1">`docker version`:
&gt;Client version: 1.7.1
&gt;Client API version: 1.19
&gt;Go version (client): go1.4.2
&gt;Git commit (client): 786b29d
&gt;OS/Arch (client): linux/amd64
&gt;Server version: 1.7.1
&gt;Server API version: 1.19
&gt;Go version (server): go1.4.2
&gt;Git commit (server): 786b29d
&gt;OS/Arch (server): linux/amd64</sentence>
		</paragraph>
		<paragraph id="3">
			<sentence id="3.1">`docker info`:
&gt;Containers: 29
&gt;Images: 53
&gt;Storage Driver: overlay
&gt; Backing Filesystem: extfs
&gt;Execution Driver: native-0.2
&gt;Logging Driver: json-file
&gt;Kernel Version: 3.10.0-229.7.2.</sentence>
			<sentence id="3.2">el7.x86_64
&gt;Operating System: CentOS Linux 7 (Core)
&gt;CPUs: 2
&gt;Total Memory: 5.671 GiB
&gt;Name: pc
&gt;ID: PM6K:ISNN:YYZM:XB5X:754X:J6TK:ZUEG:AQWJ:35HA:FRHR:HZEV:KCY4</sentence>
		</paragraph>
		<paragraph id="4">
			<sentence id="4.1">`uname -a`:
&gt;Linux pc 3.10.0-229.7.2.</sentence>
			<sentence id="4.2">el7.x86_64 #1 SMP Tue Jun 23 22:06:11 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</sentence>
		</paragraph>
		<paragraph id="5">
			<sentence id="5.1">Environment details (AWS, VirtualBox, physical, etc.):
&gt;Physical</sentence>
		</paragraph>
		<paragraph id="6">
			<sentence id="6.1">How reproducible:
&gt;100%</sentence>
		</paragraph>
		<paragraph id="7">
			<sentence id="7.1">Steps to Reproduce:
&gt;docker build - &lt;&lt;EOF
&gt;FROM busybox
&gt;RUN mkdir /tmp/a; touch /tmp/a/b
&gt;RUN rm -rf /tmp/a
&gt;EOF</sentence>
		</paragraph>
		<paragraph id="8">
			<sentence id="8.1">Actual Results:
&gt;Step 0 : FROM busybox
&gt; ---&gt; 8c2e06607696
&gt;Step 1 : RUN mkdir /tmp/a; touch /tmp/a/b
&gt; ---&gt; Running in 9843f87a09d2
&gt; ---&gt; 30abf7fd2fce
&gt;Removing intermediate container 9843f87a09d2
&gt;Step 2 : RUN rm -rf /tmp/a
&gt; ---&gt; Running in 4dc963dfb9a8
&gt;rm: can't remove '/tmp/a': Invalid argument
&gt;The command '/bin/sh -c rm -rf /tmp/a' returned a non-zero code: 1</sentence>
		</paragraph>
		<paragraph id="9">
			<sentence id="9.1">Expected Results:
&gt;Successful build</sentence>
		</paragraph>
	</description>
</bug>
