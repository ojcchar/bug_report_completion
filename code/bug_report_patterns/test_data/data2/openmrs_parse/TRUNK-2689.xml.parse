<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>TRUNK-2689</id>
    <title>Some times empty demographics tab on patient dashboard</title>
    <description>
        <paragraph id="1">
            <sentence id="1.1">When i search for a patient, i sometimes get an empty demographics tab for the patient dashboard.</sentence>
            <sentence id="1.2">I have so far not been successful at reproducing this easily.</sentence>
            <sentence id="1.3">But looks like it is caused by a null pointer exception as per the stack trace below:</sentence>
        </paragraph>
        <paragraph id="2">
            <sentence id="2.1">ERROR - errorhandler_jsp._jspService(62) |2011-09-26 18:49:40,449| Error on page /openmrs/WEB-INF/view/patientDashboardForm.jsp</sentence>
            <sentence id="2.2">javax.servlet.jsp.JspException: java.lang.NullPointerException</sentence>
            <sentence id="2.3">	at org.apache.taglibs.standard.tag.common.core.ImportSupport.acquireString(ImportSupport.java:306)</sentence>
            <sentence id="2.4">	at org.apache.taglibs.standard.tag.common.core.ImportSupport.doEndTag(ImportSupport.java:161)</sentence>
            <sentence id="2.5">	at org.openmrs.web.taglib.PortletTag.doEndTag(PortletTag.java:115)</sentence>
            <sentence id="2.6">	at org.apache.jsp.WEB_002dINF.view.patientDashboardForm_jsp._jspx_meth_openmrs_portlet_3(org.apache.jsp.WEB_002dINF.view.patientDashboardForm_jsp:5587)</sentence>
            <sentence id="2.7">	at org.apache.jsp.WEB_002dINF.view.patientDashboardForm_jsp._jspx_meth_openmrs_hasPrivilege_16(org.apache.jsp.WEB_002dINF.view.patientDashboardForm_jsp:5513)</sentence>
            <sentence id="2.8">	at org.apache.jsp.WEB_002dINF.view.patientDashboardForm_jsp._jspService(org.apache.jsp.WEB_002dINF.view.patientDashboardForm_jsp:784)</sentence>
            <sentence id="2.9">	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:93)</sentence>
            <sentence id="2.10">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)</sentence>
            <sentence id="2.11">	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:373)</sentence>
            <sentence id="2.12">	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:470)</sentence>
            <sentence id="2.13">	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:364)</sentence>
            <sentence id="2.14">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)</sentence>
            <sentence id="2.15">	at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)</sentence>
            <sentence id="2.16">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1093)</sentence>
            <sentence id="2.17">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)</sentence>
            <sentence id="2.18">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.19">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)</sentence>
            <sentence id="2.20">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.21">	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:360)</sentence>
            <sentence id="2.22">	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)</sentence>
            <sentence id="2.23">	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)</sentence>
            <sentence id="2.24">	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)</sentence>
            <sentence id="2.25">	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)</sentence>
            <sentence id="2.26">	at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:285)</sentence>
            <sentence id="2.27">	at org.mortbay.jetty.servlet.Dispatcher.forward(Dispatcher.java:126)</sentence>
            <sentence id="2.28">	at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)</sentence>
            <sentence id="2.29">	at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)</sentence>
            <sentence id="2.30">	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1047)</sentence>
            <sentence id="2.31">	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:817)</sentence>
            <sentence id="2.32">	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)</sentence>
            <sentence id="2.33">	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)</sentence>
            <sentence id="2.34">	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)</sentence>
            <sentence id="2.35">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)</sentence>
            <sentence id="2.36">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)</sentence>
            <sentence id="2.37">	at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)</sentence>
            <sentence id="2.38">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1093)</sentence>
            <sentence id="2.39">	at org.openmrs.module.web.filter.ForcePasswordChangeFilter.doFilter(ForcePasswordChangeFilter.java:65)</sentence>
            <sentence id="2.40">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.41">	at org.openmrs.module.web.filter.ModuleFilterChain.doFilter(ModuleFilterChain.java:76)</sentence>
            <sentence id="2.42">	at org.openmrs.module.xforms.web.XformsFilter.doFilter(XformsFilter.java:60)</sentence>
            <sentence id="2.43">	at org.openmrs.module.web.filter.ModuleFilterChain.doFilter(ModuleFilterChain.java:74)</sentence>
            <sentence id="2.44">	at org.openmrs.module.web.filter.ModuleFilter.doFilter(ModuleFilter.java:58)</sentence>
            <sentence id="2.45">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.46">	at org.openmrs.web.filter.OpenmrsFilter.doFilterInternal(OpenmrsFilter.java:111)</sentence>
            <sentence id="2.47">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)</sentence>
            <sentence id="2.48">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.49">	at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)</sentence>
            <sentence id="2.50">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)</sentence>
            <sentence id="2.51">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.52">	at org.openmrs.web.filter.StartupFilter.doFilter(StartupFilter.java:83)</sentence>
            <sentence id="2.53">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.54">	at org.openmrs.web.filter.StartupFilter.doFilter(StartupFilter.java:83)</sentence>
            <sentence id="2.55">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.56">	at org.openmrs.web.filter.StartupFilter.doFilter(StartupFilter.java:83)</sentence>
            <sentence id="2.57">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.58">	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)</sentence>
            <sentence id="2.59">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)</sentence>
            <sentence id="2.60">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.61">	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:360)</sentence>
            <sentence id="2.62">	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)</sentence>
            <sentence id="2.63">	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)</sentence>
            <sentence id="2.64">	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)</sentence>
            <sentence id="2.65">	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)</sentence>
            <sentence id="2.66">	at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:206)</sentence>
            <sentence id="2.67">	at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)</sentence>
            <sentence id="2.68">	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)</sentence>
            <sentence id="2.69">	at org.mortbay.jetty.Server.handle(Server.java:324)</sentence>
            <sentence id="2.70">	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:505)</sentence>
            <sentence id="2.71">	at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:829)</sentence>
            <sentence id="2.72">	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:514)</sentence>
            <sentence id="2.73">	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:211)</sentence>
            <sentence id="2.74">	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:380)</sentence>
            <sentence id="2.75">	at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:395)</sentence>
            <sentence id="2.76">	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:488)</sentence>
            <sentence id="2.77">Caused by: java.lang.NullPointerException</sentence>
            <sentence id="2.78">	at org.openmrs.web.controller.PortletController.handleRequest(PortletController.java:129)</sentence>
            <sentence id="2.79">	at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)</sentence>
            <sentence id="2.80">	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)</sentence>
            <sentence id="2.81">	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)</sentence>
            <sentence id="2.82">	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)</sentence>
            <sentence id="2.83">	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)</sentence>
            <sentence id="2.84">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)</sentence>
            <sentence id="2.85">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)</sentence>
            <sentence id="2.86">	at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)</sentence>
            <sentence id="2.87">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1093)</sentence>
            <sentence id="2.88">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)</sentence>
            <sentence id="2.89">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.90">	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:360)</sentence>
            <sentence id="2.91">	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)</sentence>
            <sentence id="2.92">	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)</sentence>
            <sentence id="2.93">	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)</sentence>
            <sentence id="2.94">	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)</sentence>
            <sentence id="2.95">	at org.mortbay.jetty.servlet.Dispatcher.include(Dispatcher.java:192)</sentence>
            <sentence id="2.96">	at org.apache.taglibs.standard.tag.common.core.ImportSupport.acquireString(ImportSupport.java:296)</sentence>
            <sentence id="2.97">	at org.apache.taglibs.standard.tag.common.core.ImportSupport.doEndTag(ImportSupport.java:161)</sentence>
            <sentence id="2.98">	at org.openmrs.web.taglib.PortletTag.doEndTag(PortletTag.java:115)</sentence>
            <sentence id="2.99">	at org.apache.jsp.WEB_002dINF.view.portlets.patientRegimen_jsp._jspx_meth_openmrs_portlet_1(org.apache.jsp.WEB_002dINF.view.portlets.patientRegimen_jsp:1635)</sentence>
            <sentence id="2.100">	at org.apache.jsp.WEB_002dINF.view.portlets.patientRegimen_jsp._jspService(org.apache.jsp.WEB_002dINF.view.portlets.patientRegimen_jsp:304)</sentence>
            <sentence id="2.101">	at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:93)</sentence>
            <sentence id="2.102">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)</sentence>
            <sentence id="2.103">	at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:373)</sentence>
            <sentence id="2.104">	at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:470)</sentence>
            <sentence id="2.105">	at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:364)</sentence>
            <sentence id="2.106">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)</sentence>
            <sentence id="2.107">	at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)</sentence>
            <sentence id="2.108">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1093)</sentence>
            <sentence id="2.109">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)</sentence>
            <sentence id="2.110">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.111">	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:360)</sentence>
            <sentence id="2.112">	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)</sentence>
            <sentence id="2.113">	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)</sentence>
            <sentence id="2.114">	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)</sentence>
            <sentence id="2.115">	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)</sentence>
            <sentence id="2.116">	at org.mortbay.jetty.servlet.Dispatcher.include(Dispatcher.java:192)</sentence>
            <sentence id="2.117">	at org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:229)</sentence>
            <sentence id="2.118">	at org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:250)</sentence>
            <sentence id="2.119">	at org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1047)</sentence>
            <sentence id="2.120">	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:817)</sentence>
            <sentence id="2.121">	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)</sentence>
            <sentence id="2.122">	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)</sentence>
            <sentence id="2.123">	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:549)</sentence>
            <sentence id="2.124">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:707)</sentence>
            <sentence id="2.125">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:820)</sentence>
            <sentence id="2.126">	at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:487)</sentence>
            <sentence id="2.127">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1093)</sentence>
            <sentence id="2.128">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:70)</sentence>
            <sentence id="2.129">	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1084)</sentence>
            <sentence id="2.130">	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:360)</sentence>
            <sentence id="2.131">	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)</sentence>
            <sentence id="2.132">	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:181)</sentence>
            <sentence id="2.133">	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:726)</sentence>
            <sentence id="2.134">	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:405)</sentence>
            <sentence id="2.135">	at org.mortbay.jetty.servlet.Dispatcher.include(Dispatcher.java:192)</sentence>
            <sentence id="2.136">	at org.apache.taglibs.standard.tag.common.core.ImportSupport.acquireString(ImportSupport.java:296)</sentence>
            <sentence id="2.137">	... 73 more</sentence>
        </paragraph>
    </description>
</bug>
