<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>TRUNK-2785</id>
    <title>Saving person attribute type with missing description should give a user friendly error message</title>
    <description>
        <paragraph id="1">
            <sentence id="1.1">When you save a person attribute type without a description, you get an exception with the stack trace below:
The validator should catch the missing description and display a normal error message.</sentence>
        </paragraph>
        <paragraph id="2">
            <sentence id="2.1">{code}</sentence>
        </paragraph>
        <paragraph id="3">
            <sentence id="3.1">SEVERE: Servlet.service() for servlet openmrs threw exception</sentence>
            <sentence id="3.2">org.hibernate.PropertyValueException: not-null property references a null or transient value: org.openmrs.PersonAttributeType.description</sentence>
            <sentence id="3.3">	at org.hibernate.engine.Nullability.checkNullability(Nullability.java:72)</sentence>
            <sentence id="3.4">	at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:290)</sentence>
            <sentence id="3.5">	at org.hibernate.event.def.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:181)</sentence>
            <sentence id="3.6">	at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:107)</sentence>
            <sentence id="3.7">	at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.saveWithGeneratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:187)</sentence>
            <sentence id="3.8">	at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTransient(DefaultSaveOrUpdateEventListener.java:172)</sentence>
            <sentence id="3.9">	at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.performSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:94)</sentence>
            <sentence id="3.10">	at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpdate(DefaultSaveOrUpdateEventListener.java:70)</sentence>
            <sentence id="3.11">	at org.hibernate.impl.SessionImpl.fireSaveOrUpdate(SessionImpl.java:507)</sentence>
            <sentence id="3.12">	at org.hibernate.impl.SessionImpl.saveOrUpdate(SessionImpl.java:499)</sentence>
            <sentence id="3.13">	at org.hibernate.impl.SessionImpl.saveOrUpdate(SessionImpl.java:495)</sentence>
            <sentence id="3.14">	at org.openmrs.api.db.hibernate.HibernatePersonDAO.savePersonAttributeType(HibernatePersonDAO.java:320)</sentence>
            <sentence id="3.15">	at org.openmrs.api.impl.PersonServiceImpl.savePersonAttributeType(PersonServiceImpl.java:217)</sentence>
            <sentence id="3.16">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</sentence>
            <sentence id="3.17">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)</sentence>
            <sentence id="3.18">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)</sentence>
            <sentence id="3.19">	at java.lang.reflect.Method.invoke(Method.java:597)</sentence>
            <sentence id="3.20">	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)</sentence>
            <sentence id="3.21">	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)</sentence>
            <sentence id="3.22">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)</sentence>
            <sentence id="3.23">	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)</sentence>
            <sentence id="3.24">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)</sentence>
            <sentence id="3.25">	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)</sentence>
            <sentence id="3.26">	at $Proxy219.savePersonAttributeType(Unknown Source)</sentence>
            <sentence id="3.27">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</sentence>
            <sentence id="3.28">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)</sentence>
            <sentence id="3.29">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)</sentence>
            <sentence id="3.30">	at java.lang.reflect.Method.invoke(Method.java:597)</sentence>
            <sentence id="3.31">	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)</sentence>
            <sentence id="3.32">	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)</sentence>
            <sentence id="3.33">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)</sentence>
            <sentence id="3.34">	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)</sentence>
            <sentence id="3.35">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)</sentence>
            <sentence id="3.36">	at org.openmrs.aop.LoggingAdvice.invoke(LoggingAdvice.java:122)</sentence>
            <sentence id="3.37">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)</sentence>
            <sentence id="3.38">	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:50)</sentence>
            <sentence id="3.39">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)</sentence>
            <sentence id="3.40">	at org.springframework.aop.framework.adapter.MethodBeforeAdviceInterceptor.invoke(MethodBeforeAdviceInterceptor.java:50)</sentence>
            <sentence id="3.41">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)</sentence>
            <sentence id="3.42">	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)</sentence>
            <sentence id="3.43">	at $Proxy220.savePersonAttributeType(Unknown Source)</sentence>
            <sentence id="3.44">	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)</sentence>
            <sentence id="3.45">	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)</sentence>
            <sentence id="3.46">	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)</sentence>
            <sentence id="3.47">	at java.lang.reflect.Method.invoke(Method.java:597)</sentence>
            <sentence id="3.48">	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)</sentence>
            <sentence id="3.49">	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)</sentence>
            <sentence id="3.50">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)</sentence>
            <sentence id="3.51">	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)</sentence>
            <sentence id="3.52">	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)</sentence>
            <sentence id="3.53">	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)</sentence>
            <sentence id="3.54">	at $Proxy220.savePersonAttributeType(Unknown Source)</sentence>
            <sentence id="3.55">	at org.openmrs.web.controller.person.PersonAttributeTypeFormController.onSubmit(PersonAttributeTypeFormController.java:90)</sentence>
            <sentence id="3.56">	at org.springframework.web.servlet.mvc.SimpleFormController.processFormSubmission(SimpleFormController.java:272)</sentence>
            <sentence id="3.57">	at org.springframework.web.servlet.mvc.AbstractFormController.handleRequestInternal(AbstractFormController.java:268)</sentence>
            <sentence id="3.58">	at org.springframework.web.servlet.mvc.AbstractController.handleRequest(AbstractController.java:153)</sentence>
            <sentence id="3.59">	at org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter.handle(SimpleControllerHandlerAdapter.java:48)</sentence>
            <sentence id="3.60">	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)</sentence>
            <sentence id="3.61">	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)</sentence>
            <sentence id="3.62">	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)</sentence>
            <sentence id="3.63">	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)</sentence>
            <sentence id="3.64">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)</sentence>
            <sentence id="3.65">	at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)</sentence>
            <sentence id="3.66">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)</sentence>
            <sentence id="3.67">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.68">	at org.openmrs.module.web.filter.ForcePasswordChangeFilter.doFilter(ForcePasswordChangeFilter.java:65)</sentence>
            <sentence id="3.69">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)</sentence>
            <sentence id="3.70">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.71">	at org.openmrs.module.web.filter.ModuleFilterChain.doFilter(ModuleFilterChain.java:76)</sentence>
            <sentence id="3.72">	at org.openmrs.module.xforms.web.XformsFilter.doFilter(XformsFilter.java:60)</sentence>
            <sentence id="3.73">	at org.openmrs.module.web.filter.ModuleFilterChain.doFilter(ModuleFilterChain.java:74)</sentence>
            <sentence id="3.74">	at org.openmrs.module.web.filter.ModuleFilter.doFilter(ModuleFilter.java:58)</sentence>
            <sentence id="3.75">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)</sentence>
            <sentence id="3.76">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.77">	at org.openmrs.web.filter.OpenmrsFilter.doFilterInternal(OpenmrsFilter.java:111)</sentence>
            <sentence id="3.78">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)</sentence>
            <sentence id="3.79">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)</sentence>
            <sentence id="3.80">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.81">	at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)</sentence>
            <sentence id="3.82">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)</sentence>
            <sentence id="3.83">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)</sentence>
            <sentence id="3.84">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.85">	at org.openmrs.web.filter.StartupFilter.doFilter(StartupFilter.java:83)</sentence>
            <sentence id="3.86">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)</sentence>
            <sentence id="3.87">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.88">	at org.openmrs.web.filter.StartupFilter.doFilter(StartupFilter.java:83)</sentence>
            <sentence id="3.89">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)</sentence>
            <sentence id="3.90">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.91">	at org.openmrs.web.filter.StartupFilter.doFilter(StartupFilter.java:83)</sentence>
            <sentence id="3.92">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)</sentence>
            <sentence id="3.93">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.94">	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)</sentence>
            <sentence id="3.95">	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)</sentence>
            <sentence id="3.96">	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:235)</sentence>
            <sentence id="3.97">	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)</sentence>
            <sentence id="3.98">	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)</sentence>
            <sentence id="3.99">	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:191)</sentence>
            <sentence id="3.100">	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:127)</sentence>
            <sentence id="3.101">	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)</sentence>
            <sentence id="3.102">	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)</sentence>
            <sentence id="3.103">	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:298)</sentence>
            <sentence id="3.104">	at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:852)</sentence>
            <sentence id="3.105">	at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:588)</sentence>
            <sentence id="3.106">	at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:489)</sentence>
            <sentence id="3.107">	at java.lang.Thread.run(Thread.java:680)</sentence>
        </paragraph>
        <paragraph id="4">
            <sentence id="4.1">{code}</sentence>
        </paragraph>
    </description>
</bug>
