<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>10426</id>
    <title>Load fails w/ FATA[0000] Error: Untar fork/exec /usr/bin/docker: argument list too long</title>
    <description>
        <paragraph id="1">
            <sentence id="1.1">"'
$ cat /tmp/image.tar | docker load
FATA[0000] Error: Untar fork/exec /usr/bin/docker: argument list too long 
"'</sentence>
        </paragraph>
        <paragraph id="2">
            <sentence id="2.1">You can get this error if you have a several hundred images on your host.</sentence>
            <sentence id="2.2">I had ~450 images (as reported by 'docker images | wc -l') and when loading a saved image it would fail consistently w/ this error.</sentence>
        </paragraph>
        <paragraph id="3">
            <sentence id="3.1">This looks like it might be related to https://github.com/docker/docker/blob/092d52281d20e3456677ac11d781abf1cd0bdd8f/graph/load.go#L41 which constructs a list of all image IDs on the host which is then serialized to JSON and passed as an argument to a subsequent exec call.</sentence>
        </paragraph>
        <paragraph id="4">
            <sentence id="4.1">After deleting my images down to ~250, 'docker load' started working again.</sentence>
        </paragraph>
        <paragraph id="5">
            <sentence id="5.1">"'
$ docker version
Client version: 1.4.1
Client API version: 1.16
Go version (client): go1.3.3
Git commit (client): 5bc2ff8
OS/Arch (client): linux/amd64
Server version: 1.4.1
Server API version: 1.16
Go version (server): go1.3.3
Git commit (server): 5bc2ff8
"'</sentence>
        </paragraph>
        <paragraph id="6">
            <sentence id="6.1">"'
$ docker info
Containers: 194
Images: 1526
Storage Driver: aufs
 Root Dir: /var/lib/docker/aufs
 Dirs: 1921
Execution Driver: native-0.2
Kernel Version: 3.13.0-24-generic
Operating System: Ubuntu 14.04 LTS
CPUs: 8
Total Memory: 15.36 GiB
Name: laptop
ID: PIYC:2PIA:5YSP:XY2N:YE2Z:KO5T:YCEJ:VWQJ:MUUO:KC54:GKES:CKFT
Debug mode (server): true
Debug mode (client): false
Fds: 10
Goroutines: 10
EventsListeners: 0
Init Path: /usr/bin/docker
Docker Root Dir: /var/lib/docker
Registry: [https://index.docker.io/v1/]
"'</sentence>
        </paragraph>
        <paragraph id="7">
            <sentence id="7.1">"'
$ uname -a
Linux laptop 3.13.0-24-generic #47-Ubuntu SMP Fri May 2 23:30:00 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
"'
</sentence>
        </paragraph>
    </description>
</bug>
