<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>4098</id>
    <title>image not updated after statements removed from Dockerfile and rebuilt</title>
    <description>
        <paragraph id="1">
            <sentence id="1.1">========================================$uname -a
Linux PTS-JSIMON2 3.11.0-15-generic #25-Ubuntu SMP Thu Jan 30 17:22:01 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</sentence>
        </paragraph>
        <paragraph id="2">
            <sentence id="2.1">$docker version
Client version: 0.7.6
Go version (client): go1.2
Git commit (client): bc3b2ec
Server version: 0.7.6
Git commit (server): bc3b2ec
Go version (server): go1.2
Last stable version: 0.8.0, please update docker</sentence>
        </paragraph>
        <paragraph id="3">
            <sentence id="3.1">$docker info
Containers: 0
Images: 14
Driver: aufs
 Root Dir: /var/lib/docker/aufs
 Dirs: 14
Username: jsimonelis
Registry: [https://index.docker.io/v1/]
# WARNING: No swap limit support</sentence>
        </paragraph>
        <paragraph id="4">
            <sentence id="4.1">1 I had a Dockerfile containing:</sentence>
        </paragraph>
        <paragraph id="5">
            <sentence id="5.1">FROM ubuntu:precise</sentence>
        </paragraph>
        <paragraph id="6">
            <sentence id="6.1">RUN echo "deb http://archive.ubuntu.com/ubuntu precise main restricted universe multiverse" &gt; /etc/apt/sources.list</sentence>
            <sentence id="6.2">RUN echo "deb http://archive.ubuntu.com/ubuntu precise-updates main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
            <sentence id="6.3">RUN echo "deb http://security.ubuntu.com/ubuntu precise-security main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
            <sentence id="6.4">RUN echo "deb-src http://archive.ubuntu.com/ubuntu precise main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
            <sentence id="6.5">RUN echo "deb-src http://archive.ubuntu.com/ubuntu precise-updates main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
            <sentence id="6.6">RUN echo "deb-src http://security.ubuntu.com/ubuntu precise-security main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
        </paragraph>
        <paragraph id="7">
            <sentence id="7.1">RUN apt-get update
RUN apt-get install -y vim-common nano
RUN apt-get install -y curl</sentence>
        </paragraph>
        <paragraph id="8">
            <sentence id="8.1">2 built with:</sentence>
            <sentence id="8.2">sudo docker build -rm=true -t $REPO_NAME .</sentence>
            <sentence id="8.3">new image created</sentence>
        </paragraph>
        <paragraph id="9">
            <sentence id="9.1">3 added to Dockerfile</sentence>
            <sentence id="9.2">RUN dpkg -i splunkforwarder-6.0.1-189883-linux-2.6-amd64.deb</sentence>
        </paragraph>
        <paragraph id="10">
            <sentence id="10.1">4 build again, new image created.</sentence>
        </paragraph>
        <paragraph id="11">
            <sentence id="11.1">5 REMOVE the line from step 3, and build again.</sentence>
            <sentence id="11.2">.</sentence>
            <sentence id="11.3">a new image wasn't created even though a statement that would change the state of the system was removed.</sentence>
        </paragraph>
    </description>
</bug>
