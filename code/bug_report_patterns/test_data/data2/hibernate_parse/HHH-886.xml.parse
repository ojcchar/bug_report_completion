<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>HHH-886</id>
    <title>hbm2ddl generating too long index on MySQL</title>
    <description>
        <paragraph id="1">
            <sentence id="1.1">SchemaExport log:</sentence>
            <sentence id="1.2">alter table CountryLocal drop foreign key FK610C39952D58FB2F;</sentence>
            <sentence id="1.3">drop table if exists CountryLocal;</sentence>
            <sentence id="1.4">drop table if exists schedule;</sentence>
            <sentence id="1.5">create table CountryLocal (</sentence>
            <sentence id="1.6">    id varchar(255) not null,</sentence>
            <sentence id="1.7">    name varchar(255) not null,</sentence>
            <sentence id="1.8">    lang varchar(255) not null,</sentence>
            <sentence id="1.9">    primary key (id, lang)</sentence>
            <sentence id="1.10">);</sentence>
            <sentence id="1.11">17:19:59,997 ERROR SchemaExport:167 - Unsuccessful: create table CountryLocal (id varchar(255) not null, name varchar(255) not null, lang varchar(255) not null, primary key (id, lang))</sentence>
            <sentence id="1.12">17:20:00,003 ERROR SchemaExport:168 - Syntax error or access violation message from server: "Specified key was too long; max key length is 1000 bytes"</sentence>
            <sentence id="1.13">create table schedule (</sentence>
            <sentence id="1.14">    id varchar(255) not null,</sentence>
            <sentence id="1.15">    primary key (id)</sentence>
            <sentence id="1.16">);</sentence>
            <sentence id="1.17">alter table CountryLocal </sentence>
            <sentence id="1.18">    add index FK610C39952D58FB2F (id), </sentence>
            <sentence id="1.19">    add constraint FK610C39952D58FB2F </sentence>
            <sentence id="1.20">    foreign key (id) </sentence>
            <sentence id="1.21">    references schedule (id);</sentence>
            <sentence id="1.22">17:20:00,014 ERROR SchemaExport:167 - Unsuccessful: alter table CountryLocal add index FK610C39952D58FB2F (id), add constraint FK610C39952D58FB2F foreign key (id) references schedule (id)</sentence>
            <sentence id="1.23">17:20:00,015 ERROR SchemaExport:168 - Base table or view not found message from server: "Table 'test_oleg.CountryLocal' doesn't exist"</sentence>
        </paragraph>
        <paragraph id="2">
            <sentence id="2.1">Mapping:</sentence>
            <sentence id="2.2">&lt;?</sentence>
            <sentence id="2.3">xml version="1.0"?</sentence>
            <sentence id="2.4">&gt;</sentence>
            <sentence id="2.5">&lt;!</sentence>
            <sentence id="2.6">DOCTYPE hibernate-mapping PUBLIC</sentence>
            <sentence id="2.7">"-//Hibernate/Hibernate Mapping DTD 3.0//EN"</sentence>
            <sentence id="2.8">"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd"&gt;</sentence>
            <sentence id="2.9">&lt;hibernate-mapping package="com.softzonenet"&gt;</sentence>
            <sentence id="2.10">&lt;class name="Test" table="schedule" lazy="false"&gt;</sentence>
            <sentence id="2.11">&lt;id name="id" type="string"&gt;</sentence>
            <sentence id="2.12">&lt;generator class="assigned" /&gt;</sentence>
            <sentence id="2.13">&lt;/id&gt;</sentence>
            <sentence id="2.14">&lt;map name="names" lazy="false" table="CountryLocal"</sentence>
            <sentence id="2.15">cascade="delete"&gt;</sentence>
            <sentence id="2.16">&lt;key column="id" not-null="true" /&gt;</sentence>
            <sentence id="2.17">&lt;map-key type="string" column="lang" /&gt;</sentence>
            <sentence id="2.18">&lt;element type="string" column="name" not-null="true" /&gt;</sentence>
            <sentence id="2.19">&lt;/map&gt;</sentence>
            <sentence id="2.20">&lt;/class&gt;</sentence>
            <sentence id="2.21">&lt;/hibernate-mapping&gt;</sentence>
        </paragraph>
        <paragraph id="3">
            <sentence id="3.1">Class:
package com.softzonenet;</sentence>
        </paragraph>
        <paragraph id="4">
            <sentence id="4.1">public class Test  {
    
    private String id = null;
    
    Test() {
        
    }</sentence>
        </paragraph>
        <paragraph id="5">
            <sentence id="5.1">public String getId() {
        return id;
    }</sentence>
        </paragraph>
        <paragraph id="6">
            <sentence id="6.1">public void setId(String id) {
        this.id = id;
    }
}</sentence>
        </paragraph>
    </description>
</bug>
