<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>HHH-3184</id>
    <title>Erroneous SQL goes to Oracle when using operator IN with composite key</title>
    <description>
        <paragraph id="1">
            <sentence id="1.1">entity Footballer has composite primary key defined via @IdClass and @Id getters (see http://www.hibernate.org/hib_docs/annotations/reference/en/html_single/#entity-mapping-identifier)</sentence>
            <sentence id="1.2">entity Goal has property 'footballer' defined via @ManyToOne</sentence>
            <sentence id="1.3">query
  select g from Goal g where g.footballer in (select f from Footballer f where f.age=22)</sentence>
            <sentence id="1.4">is translated to erroneous SQL</sentence>
        </paragraph>
        <paragraph id="2">
            <sentence id="2.1">select goal0_.</sentence>
            <sentence id="2.2">id as col_0_0_ from tgoal goal0_ where (goal0_.</sentence>
            <sentence id="2.3">fb_firstname, goal0_.</sentence>
            <sentence id="2.4">fb_lastname) in (select (footballer1_.</sentence>
            <sentence id="2.5">fb_firstname, footballer1_.</sentence>
            <sentence id="2.6">fb_lastname) from tfootballer footballer1_ where footballer1_.</sentence>
            <sentence id="2.7">age=22)</sentence>
        </paragraph>
        <paragraph id="3">
            <sentence id="3.1">it's strange, but the slightly modified query
  select g from Goal g where g.footballer.id in (select f.id from Footballer f where f.age=22)</sentence>
            <sentence id="3.2">is translated to valid SQL</sentence>
        </paragraph>
        <paragraph id="4">
            <sentence id="4.1">select goal0_.</sentence>
            <sentence id="4.2">id as col_0_0_ from tgoal goal0_ where (goal0_.</sentence>
            <sentence id="4.3">fb_firstname, goal0_.</sentence>
            <sentence id="4.4">fb_lastname) in (select footballer1_.</sentence>
            <sentence id="4.5">fb_firstname, footballer1_.</sentence>
            <sentence id="4.6">fb_lastname from tfootballer footballer1_ where footballer1_.</sentence>
            <sentence id="4.7">age=22)</sentence>
        </paragraph>
    </description>
</bug>
