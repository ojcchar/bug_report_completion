<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>4098</id>
    <title>image not updated after statements removed from Dockerfile and rebuilt</title>
    <description>
        <paragraph id="4">
            <sentence id="4.1">1 I had a Dockerfile containing:</sentence>
        </paragraph>
        <paragraph id="5">
            <sentence id="5.1">FROM ubuntu:precise</sentence>
        </paragraph>
        <paragraph id="6">
            <sentence id="6.1">RUN echo "deb http://archive.ubuntu.com/ubuntu precise main restricted universe multiverse" &gt; /etc/apt/sources.list</sentence>
            <sentence id="6.2">RUN echo "deb http://archive.ubuntu.com/ubuntu precise-updates main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
            <sentence id="6.3">RUN echo "deb http://security.ubuntu.com/ubuntu precise-security main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
            <sentence id="6.4">RUN echo "deb-src http://archive.ubuntu.com/ubuntu precise main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
            <sentence id="6.5">RUN echo "deb-src http://archive.ubuntu.com/ubuntu precise-updates main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
            <sentence id="6.6">RUN echo "deb-src http://security.ubuntu.com/ubuntu precise-security main restricted universe multiverse" &gt;&gt; /etc/apt/sources.list</sentence>
        </paragraph>
        <paragraph id="7">
            <sentence id="7.1">RUN apt-get update
RUN apt-get install -y vim-common nano
RUN apt-get install -y curl</sentence>
        </paragraph>
        <paragraph id="8">
            <sentence id="8.1">2 built with:</sentence>
            <sentence id="8.3">new image created</sentence>
        </paragraph>
        <paragraph id="9">
            <sentence id="9.1">3 added to Dockerfile</sentence>
            <sentence id="9.2">RUN dpkg -i splunkforwarder-6.0.1-189883-linux-2.6-amd64.deb</sentence>
        </paragraph>
        <paragraph id="10">
            <sentence id="10.1">4 build again, new image created.</sentence>
        </paragraph>
        <paragraph id="11">
            <sentence id="11.1">5 REMOVE the line from step 3, and build again.</sentence>
            <sentence id="11.2">.</sentence>
            <sentence id="11.3">a new image wasn't created even though a statement that would change the state of the system was removed.</sentence>
        </paragraph>
    </description>
</bug>
