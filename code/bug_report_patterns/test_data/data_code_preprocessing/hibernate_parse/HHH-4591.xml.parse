<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>HHH-4591</id>
    <title>Criteria.createAlias not working for key-many-to-one associations of a composite-id</title>
    <description>
        <paragraph id="1">
            <sentence id="1.1">I'm trying to create an alias to apply a filter on a composite primary-key association, but I'm getting an invalid SQL generated by the ctiteria api: in the SQL there is the filter applied in the where, but the join for the alias is missing in the from.</sentence>
        </paragraph>
        <paragraph id="2">
            <sentence id="2.1">Here is a sample of the problem:</sentence>
        </paragraph>
        <paragraph id="6">
            <sentence id="6.1">Code:
Criteria hibCrit = getSession().</sentence>
            <sentence id="6.2">createCriteria(TableOne.class);
hibCrit.createAlias("tableOneToTableTwo", "tableOneToTableTwo");
hibCrit.createAlias("tableOneToTableTwo.tableOneToTableTwoPk.tabelTwo", "tabelTwo");
hibCrit.add(Restrictions.eq("tabelTwo.codTabelTwo", "AAA"));
hibCrit.list();</sentence>
        </paragraph>
        <paragraph id="8">
            <sentence id="8.1">The "tabelTwo2_" should be the sql alias for criteria alias "tabelTwo", but the table and the join are missing in the from...</sentence>
        </paragraph>
        <paragraph id="9">
            <sentence id="9.1">I also tried using createCriteria:
Criteria hibCrit = getSession().</sentence>
            <sentence id="9.2">createCriteria(TableOne.class);
hibCrit.createAlias("tableOneToTableTwo", "tableOneToTableTwo");
Criteria tableTwoCrit = hibCrit.createCriteria("tableOneToTableTwo.tableOneToTableTwoPk.tabelTwo", "tabelTwo");
tableTwoCrit.add(Restrictions.eq("tabelTwo.codTabelTwo", "AAA"));
hibCrit.list();</sentence>
        </paragraph>
        <paragraph id="10">
            <sentence id="10.1">But i get the same sql query.</sentence>
        </paragraph>
        <paragraph id="11">
            <sentence id="11.1">Also upgrading Hibernate result in the same behavior.</sentence>
        </paragraph>
    </description>
</bug>
