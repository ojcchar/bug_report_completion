<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<bug>
    <id>10434</id>
    <title>mod_rewrite doesn't fill the variables as HTTPS</title>
    <description>
        <paragraph id="1">
            <sentence id="1.1">My OS is Debian with kernel 2.4.18.</sentence>
            <sentence id="1.2">I have the folowing code and go to https://somedomain/someplace, where the code 
is located in .htaccess file</sentence>
            <sentence id="1.3">.</sentence>
        </paragraph>
        <paragraph id="2">
            <sentence id="2.1">RewriteEngine        on
RewriteCond          %{REMOTE_ADDR} !</sentence>
            <sentence id="2.2">^192\.168\.1\.</sentence>
            <sentence id="2.3">[0-9]+$
RewriteCond          %{HTTPS} !</sentence>
            <sentence id="2.4">=on
RewriteRule          .</sentence>
            <sentence id="2.5">* - [F]</sentence>
        </paragraph>
        <paragraph id="3">
            <sentence id="3.1">In the log I can see, that the variable HTTPS is not set to value 'on', but 
it's empty string.</sentence>
            <sentence id="3.2">I tried other variables related to SSL, but the result was 
same.</sentence>
            <sentence id="3.3">I recompile my old version of Apache 1.3.24 and use the same above rules 
and everything was OK.</sentence>
        </paragraph>
        <paragraph id="4">
            <sentence id="4.1">The log:
192.168.201.15 - - [26/Jun/2002:16:40:48 +0200] [sova.dantax.cz/sid#81d22f8]
[rid#8250490/initial] (4) RewriteCond: input='192.168.201.15'
+pattern='!</sentence>
            <sentence id="4.2">^192\.168\.201\.14$' =&gt; matched
192.168.201.15 - - [26/Jun/2002:16:40:48 +0200] [sova.dantax.cz/sid#81d22f8]
[rid#8250490/initial] (4) RewriteCond: input='' pattern='!</sentence>
            <sentence id="4.3">=on' =&gt; matched
+REMARK this is %{HTTPS}  variable
192.168.201.15 - - [26/Jun/2002:16:40:48 +0200] [sova.dantax.cz/sid#81d22f8]
[rid#8250490/initial] (2) forcing '/var/www/htdocs/subarea/intra.</sentence>
            <sentence id="4.4">html' to be
+forbidden</sentence>
        </paragraph>
        <paragraph id="5">
            <sentence id="5.1">Rudolf Wolf</sentence>
        </paragraph>
    </description>
</bug>
